# Maple Proxy - Squid Configuration
# Only allow connections from Tailscale network

acl tailscale_net src 100.64.0.0/10
acl SSL_ports port 443
acl Safe_ports port 80
acl Safe_ports port 443
acl Safe_ports port 8080
acl CONNECT method CONNECT

# Deny requests to unsafe ports
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports

# Only allow Tailscale network
http_access allow tailscale_net
http_access deny all

# Listen on all interfaces (Tailscale IP)
http_port 3128

# Logging
access_log /usr/local/var/log/squid/access.log
cache_log /usr/local/var/log/squid/cache.log

# Basic cache settings
cache_mem 256 MB
maximum_object_size 512 MB

# Hide proxy headers for privacy
via off
forwarded_for delete
request_header_access X-Forwarded-For deny all

# DNS
dns_nameservers 8.8.8.8 8.8.4.4 1.1.1.1
